# Docker 기본

## 1️⃣ Docker 란?

- 데이터 또는 프로그램을 격리시키는 기능을 제공하는 소프트웨어

### 1) 컨테이너와 도커 엔진
- 컨테이너 (Container)
  - 애플리케이션을 실행하는 데 사용되는 가볍고 독립적인 실행 환경
  - 소프트웨어 패키지에 필요한 모든 것을 포함
- 도커 (Dokcer)
  - 컨테이너를 다루는 기능을 제공하는 소프트웨어
- 도커 엔진 (Docker Engine)
  - 도커 소프트웨어의 본체
  - 컨테이너를 생성하고 구동시킬 수 있음
- 이미지 (Image)
  - 컨테이너를 실행하는 데 필요한 모든 정보와 파일을 포함하는 패키지
  - 실행 가능한 패키지
  - 'Dockerfile' 형식의 파일을 사용하여 정의
  - 이미지 빌드에 필요한 모든 명령이 포함

### 2) Linux

<img width="572" alt="image" src="https://github.com/junseoparkk/til/assets/98972385/f091455e-39c7-4291-a22e-47aa81bf65e2">
<br><br>

- 도커를 사용하기 위해선 종류와 상관 없이 리눅스 운영체제가 필요
- Window, MacOS 에서도 도커를 구동할 수 있지만 내부적으로 리눅스가 사용됨
- 컨테이너에서 동작시킬 프로그램 또한 리눅스용 프로그램
- 도커가 리눅스 운영체제에서 사용하는 것을 전제로 개발됨

### 3) 컨테이너 기술 사용 이유
1. 보안
    - 격리된 환경은 데이터 및 프로그램을 외부 위협으로 보호 가능
    - 다른 시스템이나 사용자로부터 액세스를 차단하여 주요 정보 보호
    - 악의적인 코드 전파나 데이터 유출 방지 가능
2. 안정성 및 신뢰성
    - 격리된 환경은 하나의 컴포넌트나 애플리케이션이 실패해도 전체 시스템에 영향을 미치지 않도록 보장
    - 다른 환경에서 실행되는 프로그램에 의해 영향 받지 않고 안정적으로 운영 가능
3. 환경 충돌 방지
    - 독립된 환경에서 각 프로그램과 데이터는 서로 영향을 미치지 않음
    - 서로 다른 버전의 라이브러리 또는 의존성을 사용하는 프로그램을 동시에 실행 가능하게 하며, 환경 충돌 방지
4. 확장성
    - 독립된 환경을 추가하여 쉽게 스케일링 할 수 있음
5. 관리 용이성
    - 격리된 환경은 관리 및 유지보수에 용이
    - 각 환경은 자체적으로 관리될 수 있음
<br><br>

## 2️⃣ Server 란?

### 1) 서버 (Server)
- 말 그대로 특정 서비스(Service)를 제공(Serve) 하는 것을 가리킴
- 여러 사람이 원격으로 접근하여 사용
- 서버의 기능은 소프트웨어가 제공, 서버엔 여러 가지 소프트웨어를 설치할 수 있음
<br><br>

1. 기능적 의미의 서버
    - 특정 기능을 제공하는 것
    - e.g) Web Server, Database Server, Mail Server etc.
2. 물리적 의미의 서버
    - 컴퓨터와 마찬가지로 어딘가에 물리적으로 존재하는 컴퓨터
<br><br>

### 2) 운영체제 계열별 서버
- 서버용 운영체제로는 주로 Linux or Unix 계열을 사용

1. Window 계열
    - Windows
2. Unix 계열
    1. Linux 계열
        - Red Hat, CentOS
        - Debian, Ubuntu
        - SUSE, openSUSE
    2. BSD 계열
        - macOS
        - FreeBSD
        - NetBSD
    3. Solaris 계열
        - Solaris, OpenSolaris
<br><br>

### 3) 도커 vs 가상화 기술

![image](https://github.com/junseoparkk/til/assets/98972385/63a644a1-7c8e-4f70-8fd2-0a664961dda2)

1. 가상화 기술 (VM)
    - VirtualBox, VMware 같은 가상화 기술은 가상의 물리 서버를 만드는 것과 같음
    - 메인보드와 CPU, 메모리 등의 물리적 부품을 소프트웨어로 구현한 것
    - Host OS + Hypervisor + Guest OS 
2. 도커
    - 컨테이너는 운영체제의 일부 기능을 호스트 컴퓨터에 의존
    - 물리 서버에도 리눅스 기능이 필요하며, 컨테이너 내용도 리눅스 운영체제가 되어야 함
    - Host OS + Docker Engine
3. AWS EC2
    - EC2 역시 가상화 기술. 각각의 인스턴스가 완전히 독립된 컴퓨터처럼 동작
    - 인스턴스는 컨테이너와 마찬가지로 AMI 라는 이미지로부터 생성하므로 배포 방법은 도커와 비슷함
<br><br>

## 3️⃣ 도커의 동작 원리

### 1) 도커 구조

1. 도커 엔진 (Docker Engine)
    - 도커의 핵심 컴포넌트로서, 컨테이너의 빌드, 실행 및 관리를 담당
    - 도커 데몬 (Docker Daemon)
      - 컨테이너의 생성, 실행, 이미지 관리 담당
    - 도커 클라이언트 (Docker Client)
      - 사용자가 도커와 상호 작용할 수 있는 명령어 제공
2. 도커 이미지 (Docker Image)
    - 도커 컨테이너를 생성하는 데 사용되는 템플릿
    - 애플리케이션을 실행하는 데 필요한 모든 것을 포함
    - 읽기 전용이며, 여러 개의 레이어의 구성되어있음. 각 레이어는 파일 시스템의 변경 사항을 나타냄
3. 도커 컨테이너 (Docker Container)
    - 도커 이미지의 인스턴스로, 실행 중인 애플리케이션
    - 컨테이너는 격리된 환경에서 실행되며, 호스트 시스템과 독립적으로 실행
    - 호스트 시스템의 운영체제 커널을 공유하므로 가볍고 빠르게 시작될 수 있음
    - 주로 컨테이너 실행을 위한 가벼운 리눅스 배포판이 존재 (배포판 = 커널 + 주변부)
    - 배포판 ex) Redhat, CentOS, Ubuntu
    - 이러한 이유로 도커는 리눅스 운영체제에서만 동작, 소프트웨어 역시 리눅스용 소프트웨어
4. 도커 레지스트리 (Docker Registry)
    - 도커 이미지를 저장하고 공유하는 데 사용되는 저장소
    - 도커 허브(Docker Hub)는 가장 널리 사용되는 공개 레지스트리 중 하나, 개발자들이 이미지를 공유하고 사용 가능
<br><br>

### 2) Docker Hub, Image, Container
1. Docker Image & Container
    - 이미지는 컨테이너를 만드는 데 사용, 컨테이너의 설계도 역할
    - 이미지를 통해 동일한 컨테이너를 여러 개 배치할 수 있음
    - 반대로 컨테이너를 통해 이미지를 만들 수도 있음
    - ex) 이미지로부터 컨테이너를 만들고, 필요한 소프트웨어 등을 추가해 새로운 컨테이너를 만듦 -> 새로운 이미지를 통해 새로운 컨테이너를 만듦
    - 이미지는 도커 엔진 간에 이동할 수 있음
2. Docker Hub
    - 허브는 공식적으로 운영되는 도커 레지스트리의 이름
    - 공개된 컨테이너 이미지가 모여 있는 곳
    - 누구든지 이미지를 등록하고 공개할 수 있음
    - ex) 다양한 버전의 이미지 제공
      - 운영체제 주변부
      - 운영체제 주변부 + Apache
      - 운영체제 주변수 + Apache + MySQL
      - CentosOS 7.5, CentosOS 7.6, CentOS 7.7 등
<br><br>

### 3) 도커 컨테이너의 생애주기
- 컨테이너를 업데이트하기 보단 오래된 컨테이너를 버리고, 새로운 이미지로부터 새로운 컨테이너를 만들어 갈아타는 방식을 주로 사용
- 컨테이너 생성 -> 실행 -> 종료 -> 폐기 -> 재생성
<br><br>

### 4) 데이터 저장
- 컨테이너 폐기시 해당 컨테이너 안에서 다룬 파일과 데이터는 없어짐
- 데이터 저장을 위해 도커가 설치된 물리적 서버(호스트)의 디스크를 마운트함
  - 마운트(mount) : 디스크를 연결해 데이터를 기록할 수 있도록 한 상태
- 저장된 데이터는 다른 컨테이너와 공유 가능
<br><br>

## 4️⃣ 도커의 장단점과 용도

### 1) 도커의 핵심 : 환경 격리

1. 독립된 환경
    - 프로그램 여러 개를 띄울 수 있음
    - 똑같은 프로그램도 여러 개 띄울 수 있음
    - 일부를 교체하거나 수정이 가능
2. 이미지 생성 가능
    - 도커 허브를 통해 이미지를 직접 만들지 않고 내려받을 수 있음
    - 구축 작업이 간단해지므로 소프트웨어 업데이트와 교체가 쉬움
    - 똑같은 컨테이너를 쉽게 만들 수 있으므로 환경 이동과 개별환경 배포가 쉬움
3. 커널 포함이 필요 없음
    - 컨테이너에 커널을 포함시킬 필요가 없으므로 가벼움
    - 배포판도 원하는 것을 사용할 수 있음
- ❗️ 결국 데이터와 프로그램을 격리할 수 있기 때문에 가능한 것
<br><br>

### 2) 장점
1. 한 대의 물리 서버에 여러 대의 서버를 구축할 수 있음
    - 여러가지 기능들이 각각 안전한 상태로 실행
    - 일반 서버에서는 함께 실행할 수 없는 조합도 가능
    - 컨테이너에 커널이 포함되지 않으므로 가상화 기술에 비해 가벼움
2. 서버 관리가 용이
    - 여러 소프트웨어를 독립된 환경에 격리하므로 다른 소프트웨어의 영향을 받지 않음
    - 업데이트가 간편해 항상 최신 상태로 유지하기 쉬운 구조가 됨
    - 컨테이너 생성 및 폐기가 간단하므로 환경 이전이 쉬움
3. 쉬운 사용성
    - 명령 한 줄로 서버 구축이 가능하므로 사용성이 좋음
<br><br>

### 3) 단점
1. 리눅스용 소프트웨어만 지원
    - 도커는 리눅스 운영체제를 사용하므로 리눅스용 소프트웨어만 지원
    - 유닉스와 윈도우 서버 등의 소프트웨어는 지원하지 않음
2. 호스트 서버에 의존
    - 물리 서버 한 대에 여러 대의 서버를 띄우므로 호스트 서버에 문제가 생기면 모든 컨테이너에 영향을 미침
    - 가상화 플랫폼과 비교하면 그 영향이 미치는 범위가 큼
3. 오버헤드 발생 가능
    - 컨테이너 하나만 장기간 사용할 경우 효율이 안좋음
    - 도커 사용을 위해 도커 엔진을 구동해야 하는데, 컨테이너 하나만 사용한다면 엔진이 단순한 오버헤드에 지나치지 않음
<br><br>

### 4) 도커의 용도